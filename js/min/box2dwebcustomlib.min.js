function createBox(e,t,i,o,a){var n=new b2FixtureDef;n.density=5,n.friction=1,n.restitution=.5;var r=new b2BodyDef;r.type=b2Body.b2_dynamicBody,r.position.x=t,r.position.y=i,n.shape=new b2PolygonShape,n.shape.SetAsBox(o,a);var s=e.CreateBody(r);return s.CreateFixture(n),s}function createBall(e,t,i,o){var a=new b2FixtureDef;a.density=3,a.friction=2,a.restitution=.2;var n=new b2BodyDef;n.type=b2Body.b2_dynamicBody,n.position.x=t,n.position.y=i,a.shape=new b2CircleShape(o);var r=e.CreateBody(n);return r.CreateFixture(a),r}function buildPrismaticJoint(e,t,i,o,a){var n=new b2PrismaticJointDef;return n.Initialize(t,i,o,a),n.collideConnected=!1,n.lowerTranslation=0,n.upperTranslation=3,n.enableLimit=!0,n.maxMotorForce=400,n.motorSpeed=-.5,n.enableMotor=!0,e.CreateJoint(n)}function createStaticBox(e,t,i,o,a){var n=new b2FixtureDef;n.density=5,n.friction=1,n.restitution=.5;var r=new b2BodyDef;r.type=b2Body.b2_staticBody,r.position.x=t,r.position.y=i,n.shape=new b2PolygonShape,n.shape.SetAsBox(o,a);var s=e.CreateBody(r);return s.CreateFixture(n),s}function makeCar(e,t,i){var o=createBox(e,t,i,1,.4);o.name="chassis";var a=createBall(e,t-1.2,i+1,.4);a.name="backWheel";var n=createBall(e,t+1.2,i+1,.4);n.name="frontWheel",a.angularVelocity=0,n.angularVelocity=0;var r=createBox(e,t-1,i+.5,.4,.1),s=createBox(e,t+1,i+.5,.4,.1),c=(buildPrismaticJoint(e,o,r,new b2Vec2(t-1,i+.5),new b2Vec2(0,-1)),buildPrismaticJoint(e,o,s,new b2Vec2(t+1,i+.5),new b2Vec2(0,-1)),new b2RevoluteJointDef);c.Initialize(r,a,a.GetWorldCenter()),e.CreateJoint(c);var b=new b2RevoluteJointDef;return b.Initialize(s,n,n.GetWorldCenter()),e.CreateJoint(b),car=new Object,car.chassis=o,car.backShock=r,car.frontShock=s,car.backWheel=a,car.frontWheel=n,car}function createStaticTriangle(e,t,i,o,a){var n=new b2FixtureDef;n.shape=new b2PolygonShape,n.density=1,n.friction=2,n.restitution=.5,n.shape.SetAsArray([new b2Vec2(t[0],t[1]),new b2Vec2(i[0],i[1]),new b2Vec2(o[0],o[1])],3);var r=new b2BodyDef;r.type=b2Body.b2_staticBody,r.position.Set(a[0],a[1]);var s=e.CreateBody(r);return s.CreateFixture(n),s}function B2CanvasElement(e,t,i,o,a){var n=this;n.resize="30px",n.b2dBody=e,n.scale=t,n.image=i,n.x=function(){return e.m_sweep.c.x},n.y=function(){return e.m_sweep.c.y},n.angle=function(){return e.GetAngle()},n.xOffset=o,n.yOffset=a,void 0===n.xOffset&&(n.xOffset=0),void 0===n.yOffset&&(n.yOffset=0);var o=n.xOffset,a=n.yOffset,r=n.angle,s=n.x,c=n.y,b=!1;void 0===i&&(b=!0),this.draw=function(e){b||(e.save(),e.translate(s()*t,c()*t),e.rotate(r()),e.drawImage(n.image,-n.image.width/2+o*n.image.width,-n.image.height/2),e.restore())}}function drawB2Graphics(e,t,i){t.save(),t.fillStyle=e.b2color,t.fillRect(0,0,e.width,e.height),t.restore();for(var o=0;o<i.length;o++)i[o].draw(t)}function updateBox2dGame(e,t,i,o){e.Step(1/60,10,10),e.ClearForces(),drawB2Graphics(t,i,o)}var b2Vec2=Box2D.Common.Math.b2Vec2,b2AABB=Box2D.Collision.b2AABB,b2BodyDef=Box2D.Dynamics.b2BodyDef,b2Body=Box2D.Dynamics.b2Body,b2FixtureDef=Box2D.Dynamics.b2FixtureDef,b2Fixture=Box2D.Dynamics.b2Fixture,b2World=Box2D.Dynamics.b2World,b2MassData=Box2D.Collision.Shapes.b2MassData,b2PolygonShape=Box2D.Collision.Shapes.b2PolygonShape,b2CircleShape=Box2D.Collision.Shapes.b2CircleShape,b2DebugDraw=Box2D.Dynamics.b2DebugDraw,b2MouseJointDef=Box2D.Dynamics.Joints.b2MouseJointDef,b2RevoluteJointDef=Box2D.Dynamics.Joints.b2RevoluteJointDef,b2PrismaticJointDef=Box2D.Dynamics.Joints.b2PrismaticJointDef,b2DistanceJointDef=Box2D.Dynamics.Joints.b2DistanceJointDef;